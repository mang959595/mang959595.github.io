<!DOCTYPE html>


<html lang="zh-Hans">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title>3D RPG Demo回顾 |  b4mang95</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/images/hexo.png" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-3D-RPG-Demo回顾"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  3D RPG Demo回顾
</h1>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/" class="article-date">
  <time datetime="2023-06-06T04:46:45.000Z" itemprop="datePublished">2023-06-06</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/">游戏开发</a> / <a class="article-category-link" href="/categories/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/%E5%AE%A2%E6%88%B7%E7%AB%AF/">客户端</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> Word count:</span>
            <span class="post-count">5.2k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> Reading time≈</span>
            <span class="post-count">19 min</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="3D-RPG-Demo回顾"><a href="#3D-RPG-Demo回顾" class="headerlink" title="3D RPG Demo回顾"></a>3D RPG Demo回顾</h1><h2 id="1-创建项目"><a href="#1-创建项目" class="headerlink" title="1.创建项目"></a>1.创建项目</h2><p>包含 <strong>项目创建，渲染管线设置，资源导入，资源材质渲染升级</strong></p>
<ul>
<li>新建3D项目</li>
<li>Window-&gt;PackageManager(Packages&#x2F; Unity Registry)中下载和导入 <strong>Universal RP</strong> 通用渲染管线</li>
<li>在Assets目录中创建 Pipeline Asseet<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602103502206.png" alt="image-20230602103502206" style="zoom:67%;"></li>
</ul>
</li>
<li>导入PackageManager(Packages&#x2F; My Assets)中的资源包</li>
<li>升级资源项目的材质Material到URP<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602104131868.png" alt="image-20230602104131868" style="zoom: 67%;"></li>
<li>Window-&gt;Rendering-&gt;Render Pipeline Converter</li>
</ul>
</li>
</ul>
<h2 id="2-场景搭建"><a href="#2-场景搭建" class="headerlink" title="2.场景搭建"></a>2.场景搭建</h2><p>包括 <strong>天空盒，阴影，光照，场景搭建</strong></p>
<ul>
<li><p>天空盒设置</p>
<ul>
<li>Window-&gt;renderinh-&gt;lighting-&gt;Environment</li>
</ul>
</li>
<li><p>阴影设置</p>
<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602104716284.png" alt="image-20230602104716284"></li>
<li>在<strong>渲染管线配置文件</strong>中设置Shadow字段的参数</li>
</ul>
</li>
<li><p>光照设置</p>
<ul>
<li><p>Window-&gt;renderinh-&gt;lighting-&gt;Scene</p>
</li>
<li><p>通过设置 Lighting Settings 文件，配置光照参数</p>
</li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602105125399.png" alt="image-20230602105125399" style="zoom:80%;">

<p>设置是否在生成场景时自动渲染光照</p>
</li>
<li><p>光源：在Environment中设置光源 Environment Lighting&#x2F;Source</p>
</li>
</ul>
</li>
<li><p>场景物体摆放</p>
<ul>
<li><p>shift+F 抓取顶点</p>
</li>
<li><p>ctrl+shift+F 快速设置transform</p>
</li>
<li><p>利用空Object分割 Hierarchy 中的各类型对象</p>
</li>
<li><p>Polybrush插件</p>
<ul>
<li><p>安装：</p>
<ul>
<li>Window-&gt;PackageManager(Packages&#x2F; Unity Registry)</li>
<li>导入样例Shader<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602105808946.png" alt="image-20230602105808946" style="zoom:80%;"></li>
</ul>
</li>
<li><p>使用：Tools菜单&#x2F;Polybrush Window <img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602110016714.png" alt="image-20230602110016714" style="zoom:80%;"></p>
</li>
<li><p>使用Polybrush自带的ShaderGraph来创建材质<br><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602110307916.png" alt="image-20230602110307916"></p>
<p>使用了该材质的物体可以使用Polybrush的颜色刷子</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>场景模型创建 —— ProBuilder</p>
<ul>
<li><p>安装：跟PolyBrush差不多</p>
<p><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602110912896.png" alt="image-20230602110912896"></p>
</li>
<li><p><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602111158996.png" alt="image-20230602111158996"></p>
</li>
<li><p>新版本的参数名称有不同<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602111249173.png" alt="image-20230602111249173"></p>
</li>
</ul>
</li>
<li><p>启用Preview Package：ProGrids</p>
<ul>
<li><p>Edit&#x2F;Project Setting</p>
</li>
<li><p><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602111434848.png" alt="image-20230602111434848"></p>
</li>
<li><p>Tools&#x2F;ProGrids</p>
</li>
</ul>
</li>
</ul>
<h2 id="3-地图导航烘焙"><a href="#3-地图导航烘焙" class="headerlink" title="3.地图导航烘焙"></a>3.地图导航烘焙</h2><h3 id="Navigation"><a href="#Navigation" class="headerlink" title="Navigation"></a>Navigation</h3><ul>
<li>开启：Window-&gt;AI-&gt;Navigation</li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602112337244.png" alt="image-20230602112337244" style="zoom:80%;">
- Agent 表示的是 移动物
- 可以设置坡度、Agent模型体积等参数</li>
<li>设置物体为导航路面<ul>
<li>Static：Navigation static<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602112516103.png" alt="image-20230602112516103" style="zoom:80%;"></li>
<li>设置是否 Walkable<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602112459426.png" alt="image-20230602112459426" style="zoom:80%;"></li>
</ul>
</li>
<li>为人物添加导航组件<ul>
<li>Nav Mesh Agent：导航网格人物代理组件<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602113028687.png" alt="image-20230602113028687" style="zoom:80%;"><ul>
<li>相关参数：<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602113243270.png" alt="image-20230602113243270" style="zoom:80%;"></li>
</ul>
</li>
</ul>
</li>
<li>为障碍物添加导航组件<ul>
<li>Nav Mesh Obstacle</li>
<li>carve：可以实时切割导航路面<br><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602113445563.png" alt="image-20230602113445563"></li>
</ul>
</li>
<li>跳跃设置：没有用到</li>
</ul>
<h2 id="4-鼠标控制和人物移动控制"><a href="#4-鼠标控制和人物移动控制" class="headerlink" title="4.鼠标控制和人物移动控制"></a>4.鼠标控制和人物移动控制</h2><h3 id="MouseManager脚本"><a href="#MouseManager脚本" class="headerlink" title="MouseManager脚本"></a>MouseManager脚本</h3><ul>
<li><p>挂载在空物体 Mouse Manager</p>
</li>
<li><p>设置鼠标点击事件的处理</p>
<ul>
<li>UnityEngine.Event<ul>
<li>[System.Serializable] 序列化处理非MonoBehaviour子类，使得Unity界面中能够查看和设置该属性<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/../../../游戏开发/3D RPG/3D RPG 回顾/image-20230602115927683.png" alt="image-20230602115927683" style="zoom:80%;">
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602120050100.png" alt="image-20230602120050100" style="zoom:80%;"></li>
<li>设置事件处理<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602120216706.png" alt="image-20230602120216706" style="zoom:80%;">
- 将事件设置为NavMeshAgent自带的Destination，表示导航位置。</li>
</ul>
</li>
</ul>
</li>
<li><p>获取鼠标点击位置：利用射线和collider发生碰撞</p>
<ul>
<li><p>API：</p>
<ul>
<li>Camera.ScreenPointToRay(Vector3 position) 从屏幕发射到position的射线</li>
<li>Physics.Raycast(Ray ray, out RaycastHit hitInfo) 检测射线的碰撞</li>
</ul>
</li>
<li><p>相关参数：</p>
<ul>
<li>RaycastHit hitInfo 作为Physics.Raycast的传出参数，保存有射线的碰撞信息</li>
</ul>
</li>
<li><p>代码：</p>
<ul>
<li><p>射线发射，判断射线碰撞物体，根据物体标签设置鼠标贴图</p>
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602121109491.png" alt="image-20230602121109491" style="zoom:80%;">
</li>
<li><p>点击鼠标，触发事件处理 OnMouseClicked.Invoke(hitInfo.point) 就是 前面设置的 NavMeshAgent.Destination</p>
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602121411322.png" alt="image-20230602121411322" style="zoom:80%;">
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/../../../游戏开发/3D RPG/3D RPG 回顾/image-20230602121305501.png" alt="image-20230602121305501" style="zoom:80%;"></li>
</ul>
</li>
</ul>
</li>
<li><p>移动控制小细节：NavMeshAgent组件 的参数</p>
<ul>
<li>Stopping Distance 的大小设置可以跟攻击距离有关联</li>
<li>速度，角速度，加速度</li>
<li>自动制动 Auto Braking：提前减速，否则就是匀速到达并停止</li>
</ul>
</li>
<li><p>指针贴图设置</p>
<ul>
<li>导入PNG格式的鼠标贴图，并设置相关参数</li>
<li>脚本代码中，用 Texture2D 类型的变量保存贴图内容</li>
<li>控制代码<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602124442960.png" alt="image-20230602124442960" style="zoom: 67%;"></li>
<li>注意鼠标点击的原始位置是在 鼠标贴图的左上角顶点 ，通过 SetCursor() 的第二个参数来设置偏移使得鼠标点击位置位于贴图中央</li>
</ul>
</li>
</ul>
<h3 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h3><p>写法</p>
 <img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602122814252.png" alt="image-20230602122814252" style="zoom: 80%;">
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/../../../游戏开发/3D RPG/3D RPG 回顾/image-20230602122801102.png" alt="image-20230602122801102" style="zoom:67%;">

<p><strong>只需</strong>保证Mouse Manager的实例<strong>有且仅有一份</strong>就行了，不关心实例是否保持为最早创建的实例。</p>
<h3 id="PlayerController"><a href="#PlayerController" class="headerlink" title="PlayerController"></a>PlayerController</h3><ul>
<li>鼠标移动事件：弃用上面的 UnityEngine.Events&#x2F;EventVector3，改用 System&#x2F;event Action&lt;xxx&gt; ,xxx为参数<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602123546809.png" alt="image-20230602123546809" style="zoom:80%;"></li>
<li>工作原理：<ul>
<li>创建事件 OnMouseClicked</li>
<li>将事件处理函数注册到该事件 OnMouseClicked +&#x3D; xxx;</li>
<li>事件发生时，调用 OnMouseClicked.Invoke(arg) 会唤起所有注册了的事件处理函数</li>
</ul>
</li>
<li>代码：<ul>
<li>事件处理以及注册（PlayerController中），涉及NavMeshAgent组件<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602123936237.png" alt="image-20230602123936237" style="zoom:80%;"></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="5-相机设置"><a href="#5-相机设置" class="headerlink" title="5.相机设置"></a>5.相机设置</h2><h3 id="相机跟踪"><a href="#相机跟踪" class="headerlink" title="相机跟踪"></a>相机跟踪</h3><ul>
<li><p>安装 Cinemashine 工具</p>
</li>
<li><p>创建虚拟相机 virtual Cinemashine，设置 MainCamera的brain</p>
</li>
<li><p>设置虚拟相机的参数</p>
<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602150704716.png" alt="image-20230602150704716"></li>
<li>Aim参数-do nothing</li>
<li>follow参数-playerObjcet<ul>
<li>可以给人物加一个lookAtPoint来作为相机跟随对象</li>
</ul>
</li>
<li>虚拟相机的位置可以通过Ctrl+Shift+F调整</li>
</ul>
</li>
</ul>
<h3 id="视图后处理"><a href="#视图后处理" class="headerlink" title="视图后处理"></a>视图后处理</h3><h4 id="设置迷雾"><a href="#设置迷雾" class="headerlink" title="设置迷雾"></a>设置迷雾</h4><ul>
<li>Window-&gt;Rendering-&gt;lighting-&gt;environment-&gt;fog<ul>
<li>能见度</li>
<li>颜色</li>
</ul>
</li>
<li>Scene内也要开启fog</li>
</ul>
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602151605304.png" alt="image-20230602151605304" style="zoom:80%;">

<h4 id="Post-Processing"><a href="#Post-Processing" class="headerlink" title="Post Processing"></a>Post Processing</h4><ul>
<li><p>Main Camera中启动PostProcessing</p>
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602151731551.png" alt="image-20230602151731551" style="zoom:80%;">
</li>
<li><p>创建 Global Volume 对象</p>
<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602151427826.png" alt="image-20230602151427826" style="zoom:80%;"></li>
<li>创建 Profile ，添加并设置各种效果 Add Override<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602151630478.png" alt="image-20230602151630478" style="zoom:80%;">
- Bloom 泛光
- Color Adjustment 曝光、对比度、饱和等
- ToneMapping 色调
- Depth Of Field 景深
- Chromatic Aberration 畸变、鱼眼效果
- ...</li>
</ul>
</li>
</ul>
<h3 id="Cinemashine之-FreeLook-Camera"><a href="#Cinemashine之-FreeLook-Camera" class="headerlink" title="Cinemashine之 FreeLook Camera"></a>Cinemashine之 FreeLook Camera</h3><ul>
<li>设置 Follow 和 Look At</li>
<li>相机移动控制：<ul>
<li>Axis Control <ul>
<li>Input Axis Name：<br>可以在Project Setting-InputManager里查看<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606161237318.png" alt="image-20230606161237318" style="zoom:80%;"></li>
</ul>
</li>
<li>Orbits 移动范围<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606161432763.png" alt="image-20230606161432763" style="zoom:80%;"></li>
<li>Binding Mode 设置移动跟随 <img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606161858979.png" alt="image-20230606161858979" style="zoom:80%;"></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="6-动画控制"><a href="#6-动画控制" class="headerlink" title="6.动画控制"></a>6.动画控制</h2><ul>
<li><p>添加 Animator 组件</p>
</li>
<li><p>创建 Animator Controller 动画控制器，并设置到Animator组件中</p>
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602152928218.png" alt="image-20230602152928218" style="zoom:80%;">

<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602153026204.png" alt="image-20230602153026204" style="zoom:80%;">
</li>
<li><p>打开动画控制器</p>
<ul>
<li>在 Base Layer 创建 Blend Tree，控制基本的移动动作<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602153228523.png" alt="image-20230602153228523" style="zoom:67%;"></li>
<li>在 Blend Tree 中添加参数：Speed(float)</li>
<li>在 Blend Tree 中添加 Motion Field，并设置相应动画以及数值控制<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602153717925.png" alt="image-20230602153717925" style="zoom:80%;"></li>
</ul>
</li>
<li><p>代码：</p>
<ul>
<li>先获取 Animator 组件给anim变量</li>
<li>设置 Speed 的值<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602154108267.png" alt="image-20230602154108267" style="zoom:80%;">
- agent.velocity获取速度
- sqrMagnitude将Vector3的速度数值转为float</li>
</ul>
</li>
</ul>
<h2 id="7-利用ShaderGraph实现剔除遮挡的效果"><a href="#7-利用ShaderGraph实现剔除遮挡的效果" class="headerlink" title="7.利用ShaderGraph实现剔除遮挡的效果"></a>7.利用ShaderGraph实现剔除遮挡的效果</h2><p>ShaderGraph提供了可视化编辑渲染管线的功能</p>
<ul>
<li><p>创建 Unlit Shader Graph</p>
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602155500819.png" alt="image-20230602155500819" style="zoom:80%;">
</li>
<li><p>基于该 Shader，创建一个 Material 供后续使用</p>
</li>
<li><p>打开 Shader Graph 窗口</p>
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602162619599.png" alt="image-20230602162619599" style="zoom:80%;">
</li>
<li><p>菲涅尔效果</p>
<ul>
<li>创建 Fresnel Effect 的Node结点<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602162733920.png" alt="image-20230602162733920" style="zoom:80%;"></li>
<li>创建 Color 变量，并与菲尼尔效果节点相乘，输出给 Fragment 的 Base Color<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602163708773.png" alt="image-20230602163708773" style="zoom:80%;"></li>
</ul>
</li>
<li><p>噪点效果：</p>
<ul>
<li>创建 Dither node，并输出到 Fragment 的 Alpha</li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602170950278.png" alt="image-20230602170950278" style="zoom:80%;"></li>
</ul>
</li>
<li><p>Alpha阈值设置</p>
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602171106967.png" alt="image-20230602171106967" style="zoom:80%;"></li>
<li><p>在 Pipeline Setting 中应用该Shader</p>
<ul>
<li>打开的是另一个 URPRenderPipelineAsset 文件，带_Render后缀<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602171331027.png" alt="image-20230602171331027" style="zoom:80%;"></li>
<li>添加两个 Render Object<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602171358318.png" alt="image-20230602171358318" style="zoom:80%;">
- 一个是被遮挡的渲染模式
  - 首先取消勾选 Write Depth
    <img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602171804718.png" alt="image-20230602171804718" style="zoom: 67%;">
  - 将 Depth Test 设为 Greater
  - 设置 Layer Mask 为 Player图层
    <img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230602171948351.png" alt="image-20230602171948351" style="zoom:67%;">
- 一个是不被遮挡的渲染模式
  设置 Layer Mask 为Player图层即可，其他的为默认</li>
</ul>
</li>
</ul>
<p>附加Tip：</p>
<p>如何使得场景中的树木不遮挡鼠标射线?</p>
<ul>
<li>方法一：将树木的 Layer 设为 Ignore Raycast</li>
<li>方法二：关闭树木的 Collider 组件</li>
</ul>
<h2 id="8-敌人"><a href="#8-敌人" class="headerlink" title="8.敌人"></a>8.敌人</h2><h3 id="属性和状态"><a href="#属性和状态" class="headerlink" title="属性和状态"></a>属性和状态</h3><ul>
<li><p>在脚本代码中自动添加组件 </p>
<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606153916500.png" alt="image-20230606153916500" style="zoom:80%;"></li>
</ul>
</li>
<li><p>状态机构思：</p>
<ul>
<li>站桩 or 巡逻</li>
<li>追击</li>
<li>死亡</li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606154305351.png" alt="image-20230606154305351" style="zoom:80%;"></li>
</ul>
</li>
<li><p>其他细节：</p>
<ul>
<li>Layer 增加一层Enemy，用于在PipelineSetting里的Layer Mask加上实现遮挡剔除</li>
<li>Tag 也加上Enemy，用来设置鼠标贴图</li>
</ul>
</li>
</ul>
<h4 id="追击状态"><a href="#追击状态" class="headerlink" title="追击状态"></a>追击状态</h4><p><strong>范围内发现Player</strong></p>
<ul>
<li>视野变量，表示视野范围</li>
<li>Physics API<ul>
<li>OverlapSphere(position, Radius)  返回范围内的一组collider<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606162604976.png" alt="image-20230606162604976" style="zoom:80%;"></li>
</ul>
</li>
</ul>
<p><strong>敌人动画控制</strong></p>
<p>思路</p>
<ul>
<li>追击</li>
<li>脱战，回到站桩或巡逻</li>
<li>攻击范围内攻击</li>
</ul>
<p>动画控制器Layer：</p>
<ul>
<li>基本移动<ul>
<li>idolNormal作为初始动画</li>
<li>WalkFWD行走动画，并用bool变量做条件</li>
<li>RunFWD跑动动画</li>
</ul>
</li>
<li>攻击<ul>
<li>权值设置，覆盖&#x2F;叠加前面Layer的动画<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606163720456.png" alt="image-20230606163720456" style="zoom:80%;"></li>
<li>如何从其他Layer的动画状态切换过来 —— 创建空state，代表之前的任何一个Layer，并连接到Entry<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606164123342.png" alt="image-20230606164123342" style="zoom:80%;"></li>
<li>战斗状态动画控制，两个bool<ul>
<li>追击 Chase —— 其他动画&lt; - &gt;攻击动画</li>
<li>跟踪 Follow —— 攻击动画&lt; - &gt;跑动动画</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>代码</p>
<ul>
<li>更新动画变量<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606164427284.png" alt="image-20230606164427284" style="zoom:80%;"></li>
<li>更新脚本变量<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606164742822.png" alt="image-20230606164742822" style="zoom:80%;"></li>
</ul>
<h4 id="巡逻状态"><a href="#巡逻状态" class="headerlink" title="巡逻状态"></a>巡逻状态</h4><p><strong>随即巡逻点</strong></p>
<ul>
<li>辅助线API <img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606165110165.png" alt="image-20230606165110165" style="zoom:80%;"></li>
<li>随机获取范围内的某个点<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606165758352.png" alt="image-20230606165758352" style="zoom:80%;">
- 获取当前位置范围内的随机点，也可更改为获取固定范围内的随机点
- 可能出现的问题是获取到的点位置不可达</li>
<li>问题解决：<ul>
<li>导航API：<br>SamplePosition() 在指定范围内，找到导航网格上最近的指定Area的点<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606170502168.png" alt="image-20230606170502168" style="zoom:80%;">
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/../../../游戏开发/3D RPG/3D RPG 回顾/image-20230606171016841.png" alt="image-20230606171016841" style="zoom:80%;">
- NavMesh.AllAreas：
  <img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606170616067.png" alt="image-20230606170616067" style="zoom:80%;"></li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606170308989.png" alt="image-20230606170308989" style="zoom:80%;"></li>
</ul>
</li>
</ul>
<p><strong>状态控制代码</strong></p>
<ul>
<li>动画变量设置，移动速度设置</li>
<li>若到达目标位置内，获取新的目标点</li>
<li>若未到达目标位置，则继续移动</li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606165433686.png" alt="image-20230606165433686" style="zoom:80%;"></li>
</ul>
<p><strong>在巡逻点停留</strong></p>
<ul>
<li>LookAtTime 和 RemainLookAtTime 变量</li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606171222823.png" alt="image-20230606171222823" style="zoom:80%;"></li>
<li>在获取随机点后更新 RemainLookAtTime</li>
</ul>
<p><strong>脱战后回到巡逻状态</strong></p>
 <img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606171443224.png" alt="image-20230606171443224" style="zoom:80%;">





<h4 id="守卫状态"><a href="#守卫状态" class="headerlink" title="守卫状态"></a>守卫状态</h4><ul>
<li>定点站桩</li>
<li>若不在站桩点，则走回站桩点站桩</li>
<li>走动、站桩的动画控制（bool动画变量）<ul>
<li>回到站桩点时，利用插值计算，平滑地使对象转向原来的方向</li>
</ul>
</li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608105415137.png" alt="image-20230608105415137" style="zoom:80%;"></li>
</ul>
<h4 id="死亡状态"><a href="#死亡状态" class="headerlink" title="死亡状态"></a>死亡状态</h4><ul>
<li><p><strong>动画管理</strong></p>
<ul>
<li>创建新的Layer，Death，并设置覆盖指数为1</li>
<li>创建一个空的动画State，表示上一个动画状态<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608105557358.png" alt="image-20230608105557358"></li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608105819149.png" alt="image-20230608105819149" style="zoom: 67%;">
- 受攻击：Trigger变量，Hit，被攻击（暴击）时触发
  - 在动画事件里面判断和设置 
    <img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608110608686.png" alt="image-20230608110608686" style="zoom:80%;">
- 死亡：bool变量。Death，血量为0
  - 取消勾选，取消自循环播放
    <img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608105857413.png" alt="image-20230608105857413" style="zoom:80%;"></li>
</ul>
</li>
<li><p>主角的受伤和死亡的动画管理类似</p>
</li>
<li><p><strong>脚本管理</strong></p>
<ul>
<li>用一个bool表示是否死亡，并且同步States状态<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608110206112.png" alt="image-20230608110206112" style="zoom:80%;"></li>
<li>状态机状态处理<ul>
<li>关闭导航Agent，Collider等组件</li>
<li>延迟销毁 gameObject 对象</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="主角攻击（移动与动画）"><a href="#主角攻击（移动与动画）" class="headerlink" title="主角攻击（移动与动画）"></a>主角攻击（移动与动画）</h3><ul>
<li><p>类似OnMouseClicked事件，在Mouse Manager中增加一个OnEnemyClicked事件</p>
<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606155002407.png" alt="image-20230606155002407" style="zoom:80%;"></li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606154924557.png" alt="image-20230606154924557" style="zoom:80%;"></li>
</ul>
</li>
<li><p>还要在PlayerController中注册这个事件的回调函数EvntAttack</p>
<ul>
<li>利用 协程 + while循环 控制移动 MoveToAttcakTarge<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606155634741.png" alt="image-20230606155634741" style="zoom:80%;"></li>
<li>还要考虑到 <strong>攻击CD，攻击范围，暴击</strong> 等</li>
<li>可以在普通的移动中加上一步终止协程，否则攻击触发之后无法改变状态直至执行完这次攻击。</li>
</ul>
</li>
<li><p>动画</p>
<ul>
<li>直接拖动画文件到动画编辑窗口内，然后添加动画关联变换，设置变换条件<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230606155918381.png" alt="image-20230606155918381" style="zoom:80%;"></li>
</ul>
</li>
</ul>
<h3 id="敌人攻击"><a href="#敌人攻击" class="headerlink" title="敌人攻击"></a>敌人攻击</h3><ul>
<li>攻击动作处于状态机的 Chase 状态</li>
<li>根据相对位置和攻击距离，管理对象的动作状态（isFollow, isStopped)</li>
<li>攻击CD控制</li>
<li>暴击控制，bool动画变量</li>
<li>动画控制<ul>
<li>在攻击动画和idol动画之间切换</li>
<li>使用 Trigger 动画变量</li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608101757617.png" alt="image-20230608101757617" style="zoom:80%;"></li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608101741123.png" alt="image-20230608101741123" style="zoom:80%;"></li>
</ul>
</li>
</ul>
<h2 id="9-人物属性和数值"><a href="#9-人物属性和数值" class="headerlink" title="9.人物属性和数值"></a>9.人物属性和数值</h2><p>使用 <strong>ScriptableObject</strong> 脚本帮助生成 Asset 文件，可以制作数值模板、设置模板</p>
<p>比如<br><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230607230044721.png" alt="image-20230607230044721" style="zoom:80%;"></p>
<h3 id="基本属性"><a href="#基本属性" class="headerlink" title="基本属性"></a>基本属性</h3><p><strong>ScriptableObject脚本</strong></p>
<ul>
<li>脚本继承自<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230607230259807.png" alt="image-20230607230259807"></li>
</ul>
</li>
<li>在create菜单中添加选项<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230607230344849.png" alt="image-20230607230344849"></li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230607230426920.png" alt="image-20230607230426920" style="zoom:80%;"></li>
</ul>
</li>
<li>为Asset文件设置字段名称和属性变量<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230607230629919.png" alt="image-20230607230629919" style="zoom:80%;"></li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230607230604591.png" alt="image-20230607230604591" style="zoom:80%;"></li>
</ul>
</li>
</ul>
<p><strong>Mono Behaviour脚本</strong></p>
<ul>
<li>管理 Asset 中的数值</li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230607230808777.png" alt="image-20230607230808777" style="zoom:80%;"></li>
<li>将 Asset 中的数值读取到 Stats 脚本文件中。简化后续的数值访问（不用 Stats.Data.xxx ）。<ul>
<li>利用C# properties 属性 的语法</li>
<li>例如：MaxHealth<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230607231157397.png" alt="image-20230607231157397" style="zoom:80%;"></li>
</ul>
</li>
<li>#region xxx，#endregion 管理代码块</li>
</ul>
<h3 id="攻击属性"><a href="#攻击属性" class="headerlink" title="攻击属性"></a>攻击属性</h3><ul>
<li>数值模板：同样先创建Scriptable object脚本文件管理所创建的Asset文件的数值内容</li>
<li>数值控制：再使用Mono脚本作为组件管理数值（在脚本内获取Asset数值文件资源）</li>
</ul>
<h3 id="伤害数值计算"><a href="#伤害数值计算" class="headerlink" title="伤害数值计算"></a>伤害数值计算</h3><ul>
<li>在数值控制脚本内声明和定义攻击伤害计算方法</li>
<li>伤害处理方法以两个数值控制脚本对象作参数（attacker，defender）</li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608103721171.png" alt="image-20230608103721171" style="zoom:80%;"></li>
</ul>
<h3 id="伤害生效处理（动画事件）"><a href="#伤害生效处理（动画事件）" class="headerlink" title="伤害生效处理（动画事件）"></a>伤害生效处理（动画事件）</h3><p>简单的处理：采用动画事件，而非使用物理方法判断攻击是否生效。</p>
<ul>
<li>Animation窗口<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608103949432.png" alt="image-20230608103949432" style="zoom:80%;"></li>
</ul>
</li>
<li>攻击事件函数&#x2F;方法<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608104342103.png" alt="image-20230608104342103" style="zoom:80%;"></li>
</ul>
</li>
<li>关键帧+动画事件<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608104431072.png" alt="image-20230608104431072" style="zoom:80%;"></li>
</ul>
</li>
</ul>
<h2 id="10-泛型单例模式-与-Game-Manager"><a href="#10-泛型单例模式-与-Game-Manager" class="headerlink" title="10.泛型单例模式 与 Game Manager"></a>10.泛型单例模式 与 Game Manager</h2><h3 id="GameManager"><a href="#GameManager" class="headerlink" title="GameManager"></a>GameManager</h3><ul>
<li><p>在主角死亡时，可以用Game Manager广播主角死亡的消息</p>
</li>
<li><p>特殊图标的Script文件，用 空object 挂载</p>
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608111154847.png" alt="image-20230608111154847" style="zoom:80%;"></li>
<li><p>Game Manager存有PlayerStats数据脚本，游戏中其他的对象要访问Player的数据时，通过Game Manager访问</p>
<ul>
<li>Game Manager 如何获取Player的数据脚本？<ul>
<li>采用 观察者 模式，反向注册，当Player生成的时候，向Game Manager注册</li>
<li>Game Manager提供注册接口<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608111649709.png" alt="image-20230608111649709" style="zoom:80%;"></li>
<li>Player注册<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608113646462.png" alt="image-20230608113646462" style="zoom:80%;"></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="泛型单例模式"><a href="#泛型单例模式" class="headerlink" title="泛型单例模式"></a>泛型单例模式</h3><ul>
<li>语法<ul>
<li>泛型单例脚本<br><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608111837904.png" alt="image-20230608111837904"></li>
<li>泛型&lt;T&gt;，并且约束T为继承自 Singleton&lt;T&gt; 的类</li>
<li>不约束T能放任何类，比如Singleton&lt;Animator&gt;，约束后只能放继承自Singleton&lt;T&gt;的类，比如Singleton&lt;MouseManager&gt;</li>
<li>具体类型单例脚本<br><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608113122412.png" alt="image-20230608113122412"></li>
</ul>
</li>
<li>生成实例（严格上说是饿汉）<ul>
<li>场景生成时，Awake创建了新的Manager<ul>
<li>若原来的实例没被销毁，则销毁新生成的泛型单例对象</li>
<li>若原来的实例被销毁了，更新实例为当前泛型单例对象</li>
</ul>
</li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608112618150.png" alt="image-20230608112618150" style="zoom:80%;"></li>
</ul>
</li>
<li>获取实例（私有变量，公开属性）<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608112252141.png" alt="image-20230608112252141" style="zoom:80%;"></li>
</ul>
</li>
<li>析构<ul>
<li>当实例对象就是当前单例对象时，销毁单例对象的同时也将实例对象销毁。<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608112953207.png" alt="image-20230608112953207" style="zoom:80%;"></li>
</ul>
</li>
<li>具体类型脚本继承单例类型脚本后<ul>
<li>重写Awake，DontDestroyOnLoad(this)使得切换场景时不析构该脚本对象。<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608113523815.png" alt="image-20230608113523815" style="zoom:80%;"></li>
</ul>
</li>
</ul>
<h2 id="11-接口-与-观察者模式：订阅和广播"><a href="#11-接口-与-观察者模式：订阅和广播" class="headerlink" title="11.接口 与 观察者模式：订阅和广播"></a>11.接口 与 观察者模式：订阅和广播</h2><p>主要广播的是Player死亡的消息</p>
<h3 id="EndGameObserver-接口"><a href="#EndGameObserver-接口" class="headerlink" title="EndGameObserver 接口"></a>EndGameObserver 接口</h3><p>如名称所示，该接口意为 游戏结束的观测者 ，其接口方法则是 游戏结束时的处理方法 。</p>
<ul>
<li>接口的脚本文件以I开头<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608121427054.png" alt="image-20230608121427054" style="zoom:80%;"></li>
</ul>
</li>
<li>接口声明<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608121512905.png" alt="image-20230608121512905" style="zoom:80%;"></li>
<li>接口方法，使用（继承）了接口的脚本都要实现接口方法<ul>
<li>EndNotify</li>
</ul>
</li>
<li>继承接口和实现接口方法<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608121727677.png" alt="image-20230608121727677" style="zoom:80%;"></li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608121813288.png" alt="image-20230608121813288" style="zoom:80%;"></li>
</ul>
</li>
</ul>
<h3 id="观察者模式"><a href="#观察者模式" class="headerlink" title="观察者模式"></a>观察者模式</h3><p>Game Manager 记录所有实现了接口的对象，并在事件发生时广播消息给这些对象。</p>
<p>游戏对象作为观察者，并在Game Manager中注册，以在适当的时候接收广播消息。</p>
<ul>
<li><p>Game Manager</p>
<ul>
<li>提供注册函数和注销函数<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608122127201.png" alt="image-20230608122127201" style="zoom:80%;"></li>
<li>广播消息<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608122509030.png" alt="image-20230608122509030" style="zoom:80%;"></li>
</ul>
</li>
<li><p>在游戏对象的Controller脚本中进行注册和注销（启用和关闭时）</p>
<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608122257093.png" alt="image-20230608122257093" style="zoom:80%;"></li>
</ul>
</li>
<li><p>在Player死亡时，由PlayerController启动Game Manager的广播</p>
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608122732454.png" alt="image-20230608122732454" style="zoom:80%;"></li>
</ul>
<h3 id="接口方法的具体实现"><a href="#接口方法的具体实现" class="headerlink" title="接口方法的具体实现"></a>接口方法的具体实现</h3><ul>
<li>胜利动画<ul>
<li>单独建一个Layer，启用覆盖，并用一个bool值控制，可以从任何动画状态切换进入<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608123619992.png" alt="image-20230608123619992" style="zoom:80%;"></li>
<li>并且取消勾选 Cant Transition To Self</li>
</ul>
</li>
<li>停止其他动画状态</li>
<li>攻击目标置空</li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608123512271.png" alt="image-20230608123512271" style="zoom:80%;"></li>
</ul>
<h2 id="12-更多敌人"><a href="#12-更多敌人" class="headerlink" title="12.更多敌人"></a>12.更多敌人</h2><h3 id="独享数据文件"><a href="#独享数据文件" class="headerlink" title="独享数据文件"></a>独享数据文件</h3><ul>
<li>将 源Scriptable Object文件 作为模板，初始化一份独有的Scriptable Object文件来实际管理数值。<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608124419519.png" alt="image-20230608124419519" style="zoom:80%;"></li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608124607913.png" alt="image-20230608124607913" style="zoom:80%;"></li>
</ul>
</li>
</ul>
<h3 id="制作已有类型敌人（史莱姆和乌龟）"><a href="#制作已有类型敌人（史莱姆和乌龟）" class="headerlink" title="制作已有类型敌人（史莱姆和乌龟）"></a>制作已有类型敌人（史莱姆和乌龟）</h3><ul>
<li>相同的Controller脚本，附带相同的组件</li>
<li>自建Asset数据模板文件，并填写基础数值</li>
<li>动画：制作Animator Controller，可以用 Animator Override Controller 快速利用原有的其他Animator Controller。<ul>
<li>只能替换动画<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608134433661.png" alt="image-20230608134433661" style="zoom:80%;"></li>
<li>对有Override关系的动画控制器进行修改的话，会相互影响</li>
</ul>
</li>
<li>保存prefab</li>
</ul>
<h3 id="制作新类型敌人（兽人和石头人）"><a href="#制作新类型敌人（兽人和石头人）" class="headerlink" title="制作新类型敌人（兽人和石头人）"></a>制作新类型敌人（兽人和石头人）</h3><h4 id="兽人"><a href="#兽人" class="headerlink" title="兽人"></a>兽人</h4><ul>
<li>动画：新建Animator Controller，可以通过复制得到后进行修改，不会影响原来的动画控制器。<ul>
<li>更换动画文件</li>
<li>暴击攻击换成技能攻击，修改动画变量和切换条件</li>
</ul>
</li>
<li>脚本：主要多实现了技能攻击<ul>
<li>继承通用Controller</li>
<li>实现 KickOff 动画事件（击退效果）<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608140925727.png" alt="image-20230608140925727" style="zoom:80%;"></li>
<li>采用NavMeshAgent的velocity方法施加力<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608164531038.png" alt="image-20230608164531038" style="zoom:80%;"></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="其他内容"><a href="#其他内容" class="headerlink" title="其他内容"></a>其他内容</h4><h5 id="动画状态机"><a href="#动画状态机" class="headerlink" title="动画状态机"></a>动画状态机</h5><p><strong>角色被攻击后，设置眩晕或受击时无法移动</strong></p>
<ul>
<li>为动画状态添加Behaviour脚本<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608165206326.png" alt="image-20230608165206326" style="zoom:80%;"></li>
<li>Unity内置的状态机脚本<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608165455352.png" alt="image-20230608165455352" style="zoom:80%;">
- 分别设定 进入动画、动画执行、退出动画...时的执行内容
- 注意NavMeshAgent组件在角色死亡时会先销毁，而动画执行未结束，导致这里报错。可以将死亡时的处理代码改为将NavMeshAgent组件的Radius置0，达到死亡后对导航不挡路的效果。</li>
</ul>
<h5 id="拓展方法"><a href="#拓展方法" class="headerlink" title="拓展方法"></a>拓展方法</h5><p>给一个类加一个自己写的方法，这里是给 Transform 类添加内容</p>
<ul>
<li>语法要求：public static 类，无继承<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608185319267.png" alt="image-20230608185319267" style="zoom:80%;"></li>
<li>添加的是攻击扇形范围的角度，以及判断攻击目标是否处于角度范围内的方法<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608191039779.png" alt="image-20230608191039779" style="zoom:80%;">
- this Transform xxx 指定要添加内容的类
- Transform target 是方法的参数</li>
<li>使用：直接用transform组件调用自定义方法<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608191241671.png" alt="image-20230608191241671" style="zoom:80%;"></li>
</ul>
<h4 id="石头人"><a href="#石头人" class="headerlink" title="石头人"></a>石头人</h4><ul>
<li>动画：override 兽人的动画控制器</li>
<li>脚本：继承同样Controller</li>
<li>普通攻击带击退 ，远程攻击扔石头+击退</li>
<li>设计数值（基本数值，攻击距离，冷却，力度 …)</li>
</ul>
<p><strong>扔石头</strong></p>
<ul>
<li>对于石头<ul>
<li>为石头prefab添加控制脚本、刚体、碰撞体等组件</li>
<li>石头在生成时就飞向攻击目标（抛射），生成位置为举手抛出时的position（利用手部模型子对象的Transform）</li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608203209013.png" alt="image-20230608203209013"></li>
</ul>
</li>
<li>对于石头人<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608202826309.png" alt="image-20230608202826309" style="zoom:80%;"></li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608203244331.png" alt="image-20230608203244331" style="zoom:80%;"></li>
</ul>
</li>
</ul>
<p><strong>玩家击回石头</strong></p>
<ul>
<li><p>石头的三个状态</p>
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608213629690.png" alt="image-20230608213629690" style="zoom:80%;">
</li>
<li><p>Hit Player</p>
<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608214016997.png" alt="image-20230608214016997" style="zoom:80%;"></li>
<li>击退 + 造成伤害</li>
<li>切换状态为 Hit Nothing</li>
<li>在数据控制脚本中重载伤害计算方法<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608214217045.png" alt="image-20230608214217045" style="zoom:80%;"></li>
</ul>
</li>
<li><p>Hit Enemy</p>
<ul>
<li>伤害造成（对石头人），并销毁自身<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608214824954.png" alt="image-20230608214824954" style="zoom:80%;"></li>
<li>玩家击打石头<ul>
<li>设置石头的标签为 attackable</li>
<li>Mouse Manager添加对该标签物体的鼠标指针管理（OnEnemyClicked信号触发）<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608215320548.png" alt="image-20230608215320548" style="zoom:80%;"></li>
<li>在Player Controller里对 Hit动画事件 做文章，若攻击对象是石头，则造成击飞效果<br><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608220000170.png" alt="image-20230608220000170"><ul>
<li>要在打击后，设置石头的初速度</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Hit Nothing</p>
<ul>
<li><p>一种是击中玩家后，切换为 Hit Nothing 状态</p>
</li>
<li><p>另一种情况是，未击中玩家，当速度下降接近0时，切换为 Hit Nothing 状态</p>
<ul>
<li>在 FixedUpdate 中读写物理相关的数据</li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608215906297.png" alt="image-20230608215906297" style="zoom:80%;"></li>
</ul>
</li>
</ul>
</li>
<li><p>另外要给小狗加上刚体组件，防止跟石头穿模。并且要勾选 is Kinematic 。</p>
</li>
</ul>
<p><strong>粒子效果：石头碎裂</strong></p>
<ul>
<li><p>在Hierarchy中创建碎石效果</p>
<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608220428244.png" alt="image-20230608220428244" style="zoom:80%;"></li>
</ul>
</li>
<li><p>设置各种各样的参数</p>
<ul>
<li>Gravity Modifier 重力下落效果</li>
<li>Collision 与其他物体产生碰撞<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608220903263.png" alt="image-20230608220903263" style="zoom:80%;"></li>
<li>Start Lifetime 生命周期</li>
<li>Start Size 设为随机尺寸<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608221203967.png" alt="image-20230608221203967" style="zoom: 67%;"></li>
<li>Renderer<ul>
<li>Render mode 改为 Mesh</li>
<li>Mesh文件采用石头的Mesh</li>
<li>设置材质</li>
</ul>
</li>
<li>角度变化<ul>
<li>Rotation By Speed</li>
<li>Rotation over Lifetime</li>
</ul>
</li>
</ul>
</li>
<li><p>保存为prefab</p>
</li>
<li><p>脚本获取效果并触发效果</p>
<ul>
<li>用gameObject变量获取</li>
<li>在石头的HitEnemy状态处理代码中生成效果<br><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608221624698.png" alt="image-20230608221624698"></li>
</ul>
</li>
</ul>
<h2 id="13-简单UI"><a href="#13-简单UI" class="headerlink" title="13.简单UI"></a>13.简单UI</h2><h3 id="血条"><a href="#血条" class="headerlink" title="血条"></a>血条</h3><ul>
<li>创建画布 Canvas<ul>
<li>Render Mode 采用 World Space</li>
<li>Event Camera 设为 Main Camera</li>
</ul>
</li>
<li>创建画布的子物体：<ul>
<li>创建 Image 来作为血条</li>
<li>两条长方 square ，一红一绿，通过覆盖和改变长度来表现血条</li>
</ul>
</li>
<li>创建脚本控制UI的生成 : HealthBarUI.cs 每个有血条的角色都要挂载<ul>
<li>在每一个角色头上生成、展示血条</li>
<li>提前给每个角色prefab加一个空的子物体表示血条位置，或者也可以自己在代码中计算位置</li>
<li>脚本需要的数据成员<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608235352306.png" alt="image-20230608235352306" style="zoom:80%;">
- 相机Transform组件用于使血条平面始终平行于相机画面</li>
<li>更新血量事件。参数为当前血量和最大血量。<br><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608235059330.png" alt="image-20230608235059330"><ul>
<li>在每次攻击发生时进行触发事件（TakeDamage伤害计算函数，在数据控制脚本中）<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230608235233226.png" alt="image-20230608235233226" style="zoom:80%;"></li>
<li>注册事件处理函数<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230609000013087.png" alt="image-20230609000013087" style="zoom: 80%;"></li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230609000127215.png" alt="image-20230609000127215"></li>
</ul>
</li>
</ul>
</li>
<li>血条位置更新<ul>
<li>LateUpdate的执行时机实在本帧完成后。也可用于相机跟随之类的功能。</li>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230609000412130.png" alt="image-20230609000412130" style="zoom:80%;"></li>
</ul>
</li>
<li>若血条设置不是永久显示，需要更新显示计时<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230609000711625.png" alt="image-20230609000711625" style="zoom:80%;"></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="经验值与升级"><a href="#经验值与升级" class="headerlink" title="经验值与升级"></a>经验值与升级</h3><h4 id="数据处理"><a href="#数据处理" class="headerlink" title="数据处理"></a>数据处理</h4><p><strong>玩家数据脚本</strong></p>
<ul>
<li><p>在玩家的 Scriptable Object 文件中</p>
<ul>
<li>添加跟等级有关的数据字段<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610011457529.png" alt="image-20230610011457529" style="zoom:80%;"></li>
<li>添加经验更新方法<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610011612004.png" alt="image-20230610011612004" style="zoom:80%;"></li>
<li>升级处理方法<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610011829408.png" alt="image-20230610011829408" style="zoom:80%;"></li>
</ul>
</li>
<li><p>在外部的攻击活动中调用经验更新（击杀时）</p>
<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610012111972.png" alt="image-20230610012111972" style="zoom:80%;"></li>
</ul>
</li>
</ul>
<p><strong>UI控制脚本</strong></p>
<ul>
<li>获取UI物件<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610015511118.png" alt="image-20230610015511118" style="zoom:80%;"></li>
</ul>
</li>
<li>更新UI物件：生命值、经验值、文字<ul>
<li><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610015632242.png" alt="image-20230610015632242"></li>
<li>不建议在Update中更新<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610015742815.png" alt="image-20230610015742815" style="zoom:80%;"></li>
</ul>
</li>
</ul>
<h4 id="UI处理"><a href="#UI处理" class="headerlink" title="UI处理"></a>UI处理</h4><p>创建画布 Canvas</p>
<ul>
<li>Render Mode: Screen Space-Overlay </li>
<li>Canvas Scaler 的 Scale Mode 设为 <img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/../../../游戏开发/3D RPG/3D RPG 回顾/image-20230610015100042.png" alt="image-20230610015100042" style="zoom: 67%;">
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610015131065.png" alt="image-20230610015131065" style="zoom:67%;"></li>
</ul>
<p><strong>玩家血条</strong></p>
<ul>
<li>在画布下创建 Image<ul>
<li>调整布局位置，按住 alt+shift 选择左上角<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610014416713.png" alt="image-20230610014416713" style="zoom:80%;"></li>
<li>调整大小，具体位置，颜色</li>
<li>还需要一个子 Image 覆盖实现血条滑动效果<ul>
<li>应该是绿色，然后调整Image Type相关参数<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610014624384.png" alt="image-20230610014624384" style="zoom:80%;"></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>经验条</strong></p>
<ul>
<li>复制上面的血条，调整一下外观即可</li>
</ul>
<p><strong>等级</strong></p>
<ul>
<li>创建一个 Text 然后同上调整位置和外观</li>
</ul>
<h2 id="14-场景切换"><a href="#14-场景切换" class="headerlink" title="14.场景切换"></a>14.场景切换</h2><h3 id="传送门"><a href="#传送门" class="headerlink" title="传送门"></a>传送门</h3><ul>
<li>创建 Lit Shader Graph<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610123834553.png" alt="image-20230610123834553" style="zoom:80%;"></li>
<li>打开 shader graph <ul>
<li>设定显示模式<br><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610123948606.png" alt="image-20230610123948606"></li>
<li>创建基本节点：Twirl<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610124147731.png" alt="image-20230610124147731" style="zoom: 67%;"></li>
<li>与 Voronol 叠加<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610124217404.png" alt="image-20230610124217404" style="zoom:80%;"></li>
<li>将时间和一个float变量相乘，作为offset控制旋转速度，并用另一个float设置强度strength<br><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610124503197.png" alt="image-20230610124503197"><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/../../../游戏开发/3D RPG/3D RPG 回顾/image-20230610124605348.png" alt="image-20230610124605348" style="zoom: 67%;"></li>
<li>设置2D纹理，建立 Sample Texture 2D节点，并用一个 Texture 2D 变量指定纹理图片<br><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610124906224.png" alt="image-20230610124906224"></li>
<li>加上颜色，输出到片段着色器的 Emission<br><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610124956317.png" alt="image-20230610124956317"></li>
<li>再加上透明通道<br><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610125033851.png" alt="image-20230610125033851"><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/../../../游戏开发/3D RPG/3D RPG 回顾/image-20230610125112548.png" alt="image-20230610125112548" style="zoom:80%;"></li>
<li>双向显示，在Graph Inspector中勾选Two Sided</li>
</ul>
</li>
<li>利用做好的 Shader 创建 Material<br><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610125227192.png" alt="image-20230610125227192"></li>
<li>创建一个 Quad 物体并把材质附上，在Mesh Renderer关闭阴影，勾选 Always Refresh 查看效果<br><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610125333402.png" alt="image-20230610125333402"></li>
<li>Shader中的颜色节点勾选HDR，可以调整效果更亮&#x2F;更暗</li>
<li>使用Power节点可以再增强效果<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610125649902.png" alt="image-20230610125649902" style="zoom: 67%;"></li>
</ul>
<p><strong>传送</strong></p>
<p>每个传送门表示了 自身地点 和 传送目的地 。</p>
<ul>
<li><p>给每个传送门创建一个空子物体，作为其传送点</p>
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610125932333.png" alt="image-20230610125932333" style="zoom:80%;">
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/../../../游戏开发/3D RPG/3D RPG 回顾/image-20230610125853188.png" alt="image-20230610125853188" style="zoom:80%;">
</li>
<li><p>两个脚本管理传送</p>
<ul>
<li>TransitionPoint.cs 管理传送门标签，作为传送门的组件<br><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610130600330.png" alt="image-20230610130600330"><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610130615401.png" alt="image-20230610130615401" style="zoom:80%;"></li>
<li>TransitionDestination.cs 管理传送目的地<br><img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610130539683.png" alt="image-20230610130539683"></li>
</ul>
</li>
<li><p>传送门 碰撞检测触发传送</p>
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230610130857682.png" alt="image-20230610130857682" style="zoom:80%;">
![image-20230610130813083](3D-RPG-Demo回顾/image-20230610130813083.png)

<p>在Update里检测按键传送</p>
</li>
</ul>
<h3 id="传送"><a href="#传送" class="headerlink" title="传送"></a>传送</h3><p>用脚本控制场景切换：SceneController.cs</p>
<p>利用协程异步加载场景和切换角色位置</p>
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230626201210879.png" alt="image-20230626201210879" style="zoom:80%;">

<h4 id="同场景传送"><a href="#同场景传送" class="headerlink" title="同场景传送"></a>同场景传送</h4><p>传送过程：  </p>
<ul>
<li>获取游戏主角的object，及其agent</li>
<li>全局查找到目标传送点对象</li>
<li>停用Player对象的Agent，切换Player对象的位置角度到传送点，再启用Agent</li>
</ul>
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230626191336726.png" alt="image-20230626191336726" style="zoom:80%;">





<h4 id="跨场景传送"><a href="#跨场景传送" class="headerlink" title="跨场景传送"></a>跨场景传送</h4><p>传送过程：  </p>
<ul>
<li>异步加载场景</li>
<li>重新初始化主角的prefab，位于传送门位置</li>
<li>停用Player对象的Agent，切换Player对象的位置角度到传送点，再启用Agent</li>
</ul>
<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230626201615795.png" alt="image-20230626201615795" style="zoom:80%;">

<ul>
<li>对各种Manager，最好启用DontDestroyOnLoad<img src="/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/image-20230626201816138.png" alt="image-20230626201816138" style="zoom:80%;"></li>
</ul>
<h2 id="15-数据保存"><a href="#15-数据保存" class="headerlink" title="15.数据保存"></a>15.数据保存</h2><h2 id="16-主菜单"><a href="#16-主菜单" class="headerlink" title="16.主菜单"></a>16.主菜单</h2><h3 id="主菜单"><a href="#主菜单" class="headerlink" title="主菜单"></a>主菜单</h3><h3 id="场景切换淡入淡出"><a href="#场景切换淡入淡出" class="headerlink" title="场景切换淡入淡出"></a>场景切换淡入淡出</h3><h2 id="17-打包程序"><a href="#17-打包程序" class="headerlink" title="17.打包程序"></a>17.打包程序</h2> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://mang959595.github.io/2023/06/06/3D-RPG-Demo%E5%9B%9E%E9%A1%BE/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unity/" rel="tag">Unity</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2024/01/01/2024%E5%BC%80%E5%B9%B4%E5%A4%A7%E5%90%89/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            2024开年大吉
          
        </div>
      </a>
    
    
      <a href="/2023/06/01/%E5%88%9D%E6%8E%A2%E5%9B%BE%E5%BD%A2%E5%A4%84%E7%90%86%E6%B5%81%E6%B0%B4%E7%BA%BF%EF%BC%88%E6%B8%B2%E6%9F%93%E7%AE%A1%E7%BA%BF%EF%BC%89/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">初探图形流水线（渲染管线）</div>
      </a>
    
  </nav>

  
   
    
    <script src="https://cdn.staticfile.org/twikoo/1.4.18/twikoo.all.min.js"></script>
    <div id="twikoo" class="twikoo"></div>
    <script>
        twikoo.init({
            envId: ""
        })
    </script>
 
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2024
        <i class="ri-heart-fill heart_icon"></i> FRP
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/123.jpg" alt="b4mang95"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->
 
<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: ".tocbot",
    contentSelector: ".article-entry",
    headingSelector: "h1, h2, h3, h4, h5, h6",
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: "main",
    positionFixedSelector: ".tocbot",
    positionFixedClass: "is-position-fixed",
    fixedSidebarOffset: "auto",
  });
</script>

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>